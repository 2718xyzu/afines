\documentclass[12pt]{article}
\usepackage{times}
\usepackage{graphicx}
\usepackage{cite}
\usepackage[margin=1in]{geometry}
\usepackage{bm}
\usepackage{cleveref}
\usepackage[font=small,labelfont=bf]{caption}
\usepackage{subcaption}
\captionsetup[subfigure]{subrefformat=simple,labelformat=simple}
\renewcommand\thesubfigure{(\alph{subfigure})}
\geometry{a4paper}
\usepackage{float}
%\usepackage{cite}
\newcommand{\beginsupplement}{%
  \setcounter{table}{0}
  \renewcommand{\thetable}{S\arabic{table}}%
  \setcounter{figure}{0}
  \renewcommand{\thefigure}{S\arabic{figure}}%
}
\usepackage{array}
\newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{R}[1]{>{\raggedleft\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}

\begin{document}
\title{Tunable collective behavior in active cytoskeletal assemblies}
\author{Simon L. Freedman, Shiladitya Banerjee, Glen M. Hocky, Aaron R. Dinner}
\date{}
\maketitle
\begin{abstract}
  Cells can modulate the mechanical properties of the actin cytoskeleton in 
  remarkable ways to maintain structural  integrity, move and divide. This 
  behavior is achieved through crosslinking proteins and bundling agents that 
  dynamically control cellular structure, as well as active motors that generate
  active stresses and regulate intracellular transport. {\em In vitro} model 
  systems using a small subset of purified proteins have  revealed the minimal 
  components necessary to confer this wide range of mechanical behaviors. Here, 
  we take the same  approach using agent-based  computational modeling, and 
  investigate the collective dynamics of disordered   cytoskeletal assemblies, 
  consisting of  semi-flexible filaments, dynamic crosslinkers, and molecular 
  motors. By tuning  the properties of individual  cytoskeletal elements, such 
  as filament length, crosslinker stiffness, or motor kinetics, we explore the
  collective  phases of actomyosin networks across dynamic regimes inaccessible 
  to experiments. Our work elucidates the diverse pathways for cytoskeletal 
  contractility, polarity organization, and molecular transport, and provides 
  testable predictions for future experiments on reconstituted cytoskeletal 
  assemblies.  
\end{abstract}
\section{Introduction} 
The actin cytoskeleton serves as a dynamic scaffold that allows eukaryotic cells
to actively change shape, move, and adapt to their micro-environment. Although 
the cellular cytoskeleton constitutes a complex network of protein-protein
interactions, {\em in vitro} model systems have revealed the minimal set of 
components required to exhibit a wide range of active mechanical behaviors 
including contractility and polarity organization\cite{murrell2012,murrell2014,
takiguchi1991}. In this work, we investigate the range of collective behaviors 
accessible to a minimal system consisting of cytoskeletal filaments, 
crosslinking proteins, and active molecular motors. While previous studies have 
shed light on the mechanisms of contractility and self-organization in minimal 
cytoskeletal systems \cite{takiguchi1991,nedelec2002,dasanyake2011,murrell2012,wang2012,ennomani2016}, 
a necessary limitation is the difficulty to precisely control physical 
properties of their protein constituents. Thus, it is poorly understood how 
variations in filament stiffness, length, crosslinker geometry, and affinity 
control emergent properties of cytoskeletal assemblies.  
Here, we present an agent-based model of the actin cytoskeleton, using
non-equilibrium molecular dynamics, that can efficiently explore the 
collective phases of crosslinked actomyosin networks. Our agent-based model is
ideal for elucidating the relationship between protein-protein interactions at
the microscale and the collective mechanical behavior of the assembly.
Furthermore, our dynamic simulations enable us to learn how active networks 
sample through dynamic states, and how intermediate mesoscopic structures may 
tune network functionality at cellular scales.
\par
Actyomyosin contractility has been extensively studied in the context of  muscle
cells, where actin filaments are arranged in a sarcomeric fashion, enabling 
myosin minifilaments to translocate two anti-parallel actin filaments and yield 
active muscle contraction\cite{huxley1969}. However, the cytoskeleton of 
nonmuscle cells, exhibits no inherent ordering of actin or myosin filaments, yet
F-actin buckling has been shown to coordinate long-range contractile behavior 
\cite{lenz2012,murrell2012,murrell2015}.
Recent {\em in vitro} studies using 
reconstituted networks of actin and myosin, have revealed how changing myosin 
concentration and F-actin properties effect the ability of a disordered networks
to contract and form static structures\cite{murrell2012, murrell2014, stam2016}.
For instance, at low motor density, the 
actin network behaves as non contractil, resulting in long-distance 
translocation of myosin along actin tracks \cite{burov2013}. Above a
critical density, myosin motors cooperatively contract the actin network.
contraction. Additionally, it has been shown that actin binding proteins 
(crosslinkers) such as filamin, scruin, and $\alpha$-actinin, can profoundly 
affect long-range force propagation as well as the mechanical stability of actin
bundles and network\cite{murrell2012, murrell2014, murrell2015, gardel2004}. 
While these experiments are beginning to suggest the phase space of 
collective behavior in active networks, agent based simulations can explore in a
controlled fashion how myosin density, actin bundle rigidity, and crosslinker
density are able to modulate structure formation and force generation within the
cell cytoskeleton. 
\par
To probe the microscopic origin of these complex collective processes, we 
use a agent-based simulation model, motivated both by {\em in vitro } 
experiments as well as {\em in vivo} mechanical studies on actin and myosin 
\cite{guha2005,wilson2010}.  Elsewhere, we benchmark this model against 
canonical actomyosin experiments, such as the myosin motility assay and sheared 
crosslinked F-actin networks \cite{freedman2016} and demonstrate that our 
simulations capture several key properties of cytoskeletal networks within a
single agent-based model. 
Here, we show that our simulations predict diverse collective dynamical behaviors
in cytoskeletal assemblies, and that tuning properties of filaments, 
crosslinkers, and motors, effects this collective behavior. 
We find that crosslinker affinity modulates filament bundling and network 
coarsening in a biphasic manner. We further show that crosslinker 
stiffness can tune the strain stiffening response of actin networks in a 
simulated rheology experiment. We quantify motor-dependent contraction in active
networks and predict how the concentration of motors controls actin polarity 
sorting. These results suggest actomyosin contractility emerges from a 
competition between bundling and polarity sorting. We characterize study how 
variations in actin filament length, motor density, and motor-filament binding 
can alter motor cooperativity to translocate actin filaments, which may have
implications for optimizing the observed dynamics of polarity sorting and 
contractilit. Collectively our work demonstrates how ensembles of randomly
oriented actin filaments and crosslinkers can be rearranged by myosin motors to 
form tunable structures with distinct biophysical and mechanical functionalities. 

\section{Results}
An essential mechanical function of actomyosin networks is their contractility, 
which coordinates a variety of cellular processes, including muscle contraction,
cell motility and division. That these complex macroscopic mechanisms arise 
stochastically from simple microscopic interactions suggests the ability
to engineer materials with controllable network topologies and dynamics. 
Recently, in-vitro experiments of reconstituted actomyosin networks have 
demonstrated this controllable architecture by varying motor density and
crosslinker density and showing how they effect contractility\cite{murrell2012, murrell2014}. 
Our model shows a similar dependence of network contractility on motor density. 
Additionally, we demonstrate tunability between two modes  of network 
organization: bundling, in which dynamic crosslinkers align filaments into robust 
networks, and polarity sorting, in which motors organize filaments into 
structures of uniform polarity.
\par
For computational efficiency we have chosen to coarse grain actin filaments and
crosslinker proteins at length scales relevant for network behavior. Actin 
filaments are modeled as polar worm-like chains (WLC) such that one end of the 
chain represents the barbed end of a filament and the other end represents its 
pointed end. Crosslinkers are modeled as Hookean springs such that both ends of 
the spring (heads) can bind and unbind from filaments. A schematic of these 
network components is shown in \Cref{fig:t0}B, while the load 
dependent kinetics of crosslinkers, and the force-extension relationships
for both filaments and crosslinkers are shown in \Cref{fig:t0}C. 
\par
Experiments have shown that adding crosslinkers to assemblies of F-actin yields actin bundles 
\cite{gardel2004, murrell2012, murrell2014} and that increasing crosslinker 
density can increase the length scale of contraction \cite{murrell2012}. 
We show that varying the stiffness of these springs modulates the rheology 
of an assembly of crosslinkers and filaments, while varying the binding affinity
effects the magnitude of actin bundling. We parameterized our model in $2D$ 
similar to the nearly flat in vitro reconstitutions of actomyosin. This setup is
sufficient to reproduce structures of biological interest, and allows us to 
simulate large systems for long times. Because we use a $2D$ system to model a 
$3D$ experiment, we exclude the steric interactions of filaments and 
crosslinkers, to allow for some of the freedom lost from the reduction in 
dimensionality.
\subsection{Crosslinker turnover modulates bundling of filament networks}
The rapid binding and unbinding of crosslinking proteins from actin
filaments can reorganize initially disordered filament networks into 
thick bundled networks. This behavior is distinct from motor-driven 
contractility, because the overall network structure coarsens without
any active force generation. Here we tune this bundling mechanism by
changing the crosslinker-filament binding affinity. 
\par
To demonstrate this behavior, thirteen simulations were initialized with $500$ 
$15\mu m$ worm-like-chain filaments scattered on a $(75\mu m)^2$
simulation cell, and $0.15\mu m$ crosslinkers placed at filament-filament 
intersections as shown in \Cref{fig:t0}A. The assemblies were evolved via 
Brownian dynamics for $200s$. Each simulation had a different dissassociation 
rate for crosslinkers $k_{off}^{cl}$ varying logarithmically between 
$0-1800 s^{-1}$. The results, shown in \Cref{fig:bundle}A, indicate that for
certain initializations the crosslinkers bundled actin filaments to yield 
highly connected networks. 
\par
\begin{figure}[H] 
  \centering
  \includegraphics[scale=1.2]{figs/t0.pdf}
  \caption{\label{fig:t0}Computational actomyosin network representation.
  (A) Initial configuration of an assembly of actin filaments (red) which 
  initially have crosslinkers (yellow, one third shown) placed at intersections.
  Cell size is $(75\mu m)^2$. 
  (B) Zoom in of the network revealing that crosslinkers can attach and detach 
  to actin filaments, as well as the bead-spring filament representation of 
  actin described in Methods.
  (C) Schematic of the load dependent detachment rate of crosslinkers, the 
  linear stiffness of crosslinkers, and the nonlinear force extension curve for
  filaments.
  }
\end{figure}
We have quantified the structural rearrangements inherent in bundling by the 
emergent density heterogenity and local alignment. 
Density heterogenity, is measured using the radial
distribution function of actin filaments  $g(r) = P(r)/(2\pi r \delta r\rho)$ 
where $P(r)$ is the probability that two beads on different filaments are 
separated by a distance $r$, $\delta r =0.05 \mu m$ is the bin size and 
$\rho = 500/(75\mu m)^2$ is the number density. \Cref{fig:bundle}B showns that 
for the a bundled configuration the width of the peak of $g(r)$ increases over 
time indicating that more actin filaments are brought closer together. 
Local alignment of actin filaments is measured via the $2D$ nematic order 
parameter $s_2=2\langle\cos^2{\phi_i}\rangle-1$, where $\phi_i$ is the angle 
between a filament link and its local director, defined as the average angle of 
links less than a distance of $1\mu m$.
\par
\Cref{fig:bundle}C shows that $g(r)$ for the final configuration ($t=200s$) 
shows a non-monotonic dependence on crosslinker detachment rate. 
Similarly, \Cref{fig:bundle}D, shows that over time, the nematic order of these
more bundled networks increases to a higher value than the lower bundled
networks. Together, \Cref{fig:bundle}C-D indicate that a low disassociation rate
does not allow for significant restructuring from the 
initially random configuration, and a high disassociation rate will not yield 
long-lived stable structures. However, at intermediate values of $k_{off}^{cl}$,
the filaments self-assemble into a stable, thickly bundled network. This 
relationship is in contrast to the dependence of bundling on crosslinker density, 
which as shown in the Supplement indicates that more crosslinkers yield more 
bundling. 
\par
\begin{figure}[H] 
  \centering
  \includegraphics[scale=1.2]{figs/bundling/full_figure.pdf}
  \caption{%
  \label{fig:bundle}%
  Dependence of network bundling on crosslinker detachment rate.
  (\textbf{A}) Network configuration at $t=200s$ for varying disassociation 
  constants of crosslinks (not shown). Filaments are shown in red. 
  (\textbf{B}) Radial distrbiution function of beads on an actin filament for 
  the $k_{off}=20 s^{-1}$ at various times throughout the simulation. 
  (\textbf{C}) Radial distribution function of actin filaments at $t=200s$ for 
  varying $k_{cl}^{off}$.  
  (\textbf{D}) Local ematic order of actin filaments as a function of time for 
  the same values of $k_{cl}^{off}$.  
}
\end{figure}
\subsection{Cooperative sorting of filament polarity by molecular motors}
Molecular motors are modeled as active crosslinkers such that a bound head 
precessively walks toward the barbed end of the filament with load dependent 
speed and kinetic (see Methods for details).
This implementation allows for active filament sliding and filament buckling, 
as elucidated in \cite{freedman2016},
both of which are instrumental for actomyosin contractility \cite{murrell2012}.
In large networks, motors can translocate across filaments, induce filament 
buckling, and also enhance network connectivity\cite{murrell2014}. 
\par
To isolate the role of active motors on assemblies of semiflexible filaments,
the actin assembly in \Cref{fig:t0} was generated without crosslinkers at
filament intersections, but with $0.5\mu m$ long motor minifilaments
scattered uniformly throughout the simulation cell. In these simulations, the 
motor duty ratio was kept near unity to replicate the behavior of a myosin 
minifilament, while the density of motors was varied between different
simulations. The results, shown in \Cref{fig:polarity_sorting}, indicate that at
higher motor densities, filaments are sorted by polarity, but are 
not clustered in space. Motors aggregated on the barbed ends of filaments
and thereby brought the different barbed ends together to form asters.
The magnitude of polarity sorting was measured by calculating the contribution 
to the radial distribution function by the barbed ends of actin filaments.
This value, $g(r_{barb}$ is shown in \Cref{fig:polarity_sorting}B and peaks at
significantly higher values than $g(r)$. It is clear from this 
figure that the degree of polarity sorting is highly dependent on motor density.
\par
A secondary peak is visible in \Cref{fig:polarity_sorting} at 
$r_{barb}\approx0.5\mu m$, which the rest length of the the molecular motors. 
This indicates that the motors responsible for polarity sorting remain at the 
center of asters. We calculate the average distance of a bound motor from the 
barbed end of filament to which it was bound to verify that this is the 
mechanism of polarity sorting. 
As seen from \Cref{fig:polarity_sorting}C-D, increasing motor density had the
effect of decreasing this distance, indicating a larger magnitude of polarity
sorting. Thus, motor density tunes the magnitude of polarity sorting in 
assemblies of motors and filaments. Motor-filament affinity also plays an 
important role (see Supplement) where we have shown that the most polarity 
sorted networks emerge from intermediate values of motor detachment. 
\begin{figure}[H] 
\centering
    \includegraphics[scale=1.2] {figs/polarity_sorting/ps_fig.pdf}
  \caption{%
  \label{fig:polarity_sorting}%
  (A) Networks at their polarity sorted end configuration ($t=96s$). 
  Filaments are shown in red, motors in white. A maximum of $1000$ motors are
  shown in each case.
 (B) Radial distribution function for barbed ends ($t=96s$) shows a strong 
 dependence on motor density. For $\rho_m=5\mu m^{-2}$, a prominent secondary 
 peak is also visible at the motor rest length $l_m=0.5\mu m$.
 (C) Probability density of the distance of an attached motor
   head from the barbed end of the filament to which it is attached for the same
   simulations.
 (D) The average distance of a motor head from the barbed end as a function of
 motor density.
 } 
 \end{figure}
\subsection{Contractility emerges from competition between bundling and polarity sorting}
\par
When both crosslinkers and motors are mixed with semiflexible filaments, the
assemblies become contractile. To elucidate this behavior, actin filament 
assemblies were initialized (see \Cref{fig:t0}) with crosslinkers at their
intersections with motors scattered uniformly throughout the cell. The motor
density varied between simulations from $0.1-10\mu m^{-2}$. The crosslinkers 
were kept sticky with a low duty ratio, while the motors were highly active with
a high duty ratio. This ensured that connectivity of the network was almost
exclusively controlled by crosslinkers while force generation was controlled by
motors. 
\par
The results of these simulations and the final network configurations can be
seen in \Cref{fig:contract}. The net contractility was measured by
interpolating a velocity field from the displacement vectors of filament beads
from each simulation snapshot, 
measuring the divergence at each point on the vector field, and summing the 
values. A negative total divergence of a given snapshot indicates at that time
the network was contractile. As evident in \Cref{fig:contract}B
higher motor density leads to larger contractility. \Cref{fig:contract}C-D shows
that actin buckling, here measured as the change in the end to end distance
$\Delta s$ of an actin filament:
\begin{equation} 
  \Delta s = \left(1 - {|r_{15}-r_0|\over\sum_{i=1}^{15}{|r_i-r_{i-1}|}}\right) 
  \label{eqn:fil_strain}
\end{equation} 
correlates with contractility, suggesting that the primary mechanism driving
contractility in these flexible networks is filament buckling, as observed 
in experiment \cite{murrell2012}. Networks with low motor densities and extremely
low motor disassocation rates (both with and without crosslinkers) were also 
shown to be contractile, as seen in the supplement.
\begin{figure}[H] 
  \centering
  \includegraphics[scale=1.2]{figs/divergence/div_fig.pdf}
  \caption{%
  \label{fig:contract}%
  Assemblies with motors and crosslinkers yield contraction.
  (A) Networks configurations at their largest contractile strains for different
  motor densities. Filaments are shown in red, and motors in white. Only $1000$
  motors are shown in each case.
  (B) Spatially averaged divergence of filament flow field as a function of time
  for networks of varying motor density. 
  (C) Average filament strain (defined in \Cref{eqn:fil_strain}) as a function
  of time for the same networks. 
  (D) Correlation between filament strain and the network strain
  averaged over bins of size $0.005$ for all motor densities
 } 
\end{figure}  
\section{Discussion}
The goal of this paper is to introduce a framework that could accurately and
efficiently simulate active networks of filaments, motors, and crosslinker 
proteins and predict the various structural and mechanical phases of the system.
We have successfully shown that crosslinkers can bundle filaments into thick,
connected networks, motors can sort filaments into structures of homogenous 
polarity, and both can work together to yield actomyosin contraction. We have
characterized the bundled networks via their local alignment, polarity sorted 
networks by the radial distribution function of filament barbed ends, and 
demonstrated contractility by measuring instantaneous network divergence. 
We summarize these results in \Cref{fig:phases}.
\begin{figure}[H]
  \centering
  \includegraphics[scale=0.8]{figs/phase_diagram.pdf}
  \caption{Structural phases of crosslinked actomyosin networks. For blue 
    data points, $\rho$ and $P(detach)$ parameterizes the crosslinkers, 
    while for red and black curves, they parameterize the motors.
  (A) Nematic order of structures emergent from a range of densities and 
  rates for motors and crosslinkers. 
  (B) The probability that filament barbed ends are separated by less
than $1\mu m$ with respect to the probability that arbitrary filament positions 
are separated by less than $1\mu m$.
(C) Total divergence of these networks. Extremely low values at low detachment 
rates indicate that the network was ripped apart.
(D) Phase diagram of all networks at all times. Bundling is measured via nematic
order, polarity sorting as $P(r_{barb})/P(r)$ and contractility as total 
divergence. }
  \label{fig:phases}
\end{figure}
\Cref{fig:phases}A shows that we have characterized bundling using the nematic 
order parameter and that the most locally aligned networks occur when only 
crosslinkers are present. 
This alignment can be tuned by varying both crosslinker density and 
crosslinker detachment rate. For networks with both motors and crosslinkers, 
bundling occurs when motors have a high detachment rate, as the polarity sorting
mechanism is dominated by the bundling mechanism. 
In \Cref{fig:phases}B, we have measured polarity sorting by calculating 
the probability that two filament barbed ends are separated by a 
distance of less than $1\mu m$ with respect to the probability that arbitrary 
positions on a filament are separated by a distance of less than $1\mu m$. 
In this case motors are the key restructuring agent, and higher motor density
yields a stronger polarity sorting effect. The introduction of a small 
population of crosslinkers inhibits this effect slightly, as seen from the black
curve in the left hand plot of \Cref{fig:phases}B, and contraction begins to 
dominate. Network contraction dependence on density and detachment rates 
is measured via the total divergence (summed over space and time) 
shown in \Cref{fig:phases}C, where it is clear that the combination of 
motors and crosslinkers yields the highest values of contraction and that one
can tune this effect by varying motor density and motor detachment rate. 
We used theses order parameters to develop a phase diagram (\Cref{fig:phases}D)
and show that bundling, and polarity sorting, are distinct structural phases
which can couple to yield contractile behavior. 
\par
Each of these structural organization techniques have distinct {\em in vivo}
biomechanical applications. 
Actin bundles can function as force chains to propogate stress large distances
across the cell, and bundled networks can be used to stabilize the cell 
interface, which may be necessary for the formation of an immunological synapse 
\cite{comrie2015}. Polarity sorting can yield directed networks useful for long 
distance transport of 
material across the cell. Actomyosin contraction is necessary for diverse
cell-morphology phenomona including motility and division.
\par
Other actomyosin models have explored the driving mechanisms behind
contractility and structure formation. Dasanyake, et. al., extended the
equilibrium, $2D$ crosslinked rigid filament network model in \cite{head2003} to
include a term in the potential energy that corresponded to myosin motor
activity, and observed the emergence of force chains that transmit stress
throughout the network\cite{dasanyake2011}. Wang and Wolynes \cite{wang2012}
model the F-actin networks as a graph of crosslinkers (nodes) and rigid actin
filaments (edges) in which myosin motor activity is simulated via antisymmetric
kicks along the filaments and predict a binary phase diagram of networks which
are either contractile or not as a function of cross linker and myosin
densities. While the simplicity of these models is intriguing, they do not
account for explicit filament buckling, and their integration is performed via
Monte Carlo, more applicable to structure formation than dynamics.
Nedelec used dynamic simulations of ensembles of filaments
and motor proteins to explore aster formation in microtubule-kinesin assemblies,
as well as motility and contractility in actomyosin
\cite{nedelec2002,nedelec2007,ennomani2016}. 
Kim used an agent based approach of filaments, motors and crosslinkers, to
explore a variety of topics, including bundling via parallel actin crosslinkers 
and force generation by myosin motors\cite{kim2009b, kim2014}. We have
contributed to this area by showing that a single model, benchmarked against
experiments that characterize the individual components of the system, and not
collective behavior\cite{freedman2016}, can still capture many relevant 
biophysical structures. Furthermore, we precisely quantify these behaviors 
and show how to tune them via experimentally manipulateable physical parameters. 
\par 
There are still many unanswered questions regarding self-organization in
actomyosin networks that we hope can be addressed using this simulation, such as
how actomyosin controls the shape of cell membranes, and how they form force
propogating chains across the cytoskeleton\cite{fraley2005,dasanyake2011}. 
In particular, it is significantly easier to measure internal active forces and
energies in simulation than in experiment, so we expect this model will aid the
process of isolating the particular mechanisms involved in restructuring these
polymer assemblies. We stress, however, that the applicability of such a
simulation package reaches beyond studying the phases of actomyosin networks.  
We believe this simulation can shed light on the mechanics and dynamics of 
a variety of active polymer assemblies.
\par
Similar networks that involve other proteins also exist in the
cytoskeleton, such as microtubule-kinesin-dynein networks and could be
investigated using this simulation methodology. From a more global perspective, 
the cytoskeleton
demonstrates how populations of simple machines can self assemble into active
materials with useful mechanical properties, and one can use this simulation to
efficiently design these types of self assembled materials. Thus, the
non-equilibrium molecular dynamics framework of this simulation can be used to
model and study many open questions in active matter and biophysics.
\section{Methods}  
%\subsection{Actin Filaments}
Actin filaments are treated as a worm-like chain, with each filament represented
as a set of $N+1$ beads connected by $N$ harmonic springs (links) to 
maintain a fixed end to end distance, and an 
additional harmonic angular potential applied on the $N-1$ angles along the
chain, as depicted in \Cref{fig:t0}B, to maintain a constant persistence length.
Thus, the internal forces on actin filaments can be obtained from the gradient of the
potential energy $U_f$
\begin{eqnarray} 
  U_f &=& {k_a\over2}\sum_{i=1}^{N}{(|d_i| - l_a)^2} + {\kappa_B\over 2l_a}\sum_{i=2}^N{\theta_i^2}
  \label{eqn:Ufil}
\end{eqnarray}
where $d_i = r_i-r_{i-1}$, $\theta_i = \arccos{\left({d_i\cdot d_{i-1}\over |d_i||d_{i-1}|}\right)}$, $k_a$ is the
stretching force constant, $\kappa_B$ is the bending modulus, and $l_a$ is the
equilibrium length of a link. The value for $\kappa_B$ was chosen based on the
persistence length of F-actin, $L_p\approx20\mu m$, since $\kappa_B=L_p*k_BT$ 
where $T$ is the temperature and $k_B$ is Boltzmann's constant\cite{rubinstein},
while $l_a$ was chosen to make the filament flexible at the appropriate length
scale and $k_a$ was chosen to keep the the filament sufficiently inextensible \cite{freedman2016}.
%\subsection{Crosslinkers}
Crosslinkers are modeled as hookean springs, with stiffness $k_{cl}$ and rest length $l_{cl}$
with two heads that can stochastically bind to filaments. 
The probability of a head attaching to an actin filament is a Gaussian
distributed random variable, such that
\begin{equation}
  P_{cl}^{on} = k_{cl}^{on}dt\exp(-r^2/R^2)
  \label{eqn:cl_on}
\end{equation} 
where $r$ is the shortest distance from the head to the actin filament and $R = \sqrt{2k_B T\over k_{cl}}$ 
where $k_B$ is Boltzmann's constant and $T$ is the temperature. 
The probability of crosslinker detachment is modeled as that of a slip bond,
such that a higher tensile force along the crosslinker backbone will result in a 
higher probability of detachment\cite{bell1978}; i.e.,
\begin{equation} 
  P_{cl}^{off} = k_{cl}^{off} dt\exp{\left(  F x_{cl}/k_B T\right)}  
  \label{eqn:cl_off}
\end{equation}
where $F$ is the force along the crosslinker backbone, and $x_{cl}$ is a
characteristic bond length \cite{stam2015}. 
Crosslinkers propagate their tensile force actin filaments via the lever rule outlined in 
\cite{nedelec2002, gordon2012, freedman2016}. 
% \subsection{Motors}\label{sec:methods_motors} 
\par
Motor proteins as modeled as crosslinkers  
with the subscript $m$ replacing the subscript $cl$ in \Cref{eqn:cl_on,eqn:cl_off}
One extra parameter is needed $k_m^{end}$ for the detachment of myosin from the
barbed end of a filament, as detachment from the end occurs at different rates 
than from the rest of the filament. 
Unlike crosslinkers, motors process towards the barbed end of actin filaments to which they are bound 
at speeds that vary depending on the tensile force along the crosslinker\cite{stam2015}.
The relationship between motor velocity and tensile force is modeled linearly, 
going to $0$ when the force on the minifilament is the stall force $F_s\approx 3.85pN$ \cite{nedelec2002, gordon2012}; i.e.,  
\begin{equation}  
  v(F_{||}) = v_0\left( 1-{F_{||}\over F_s}) \right)
    \label{eqn:myo_vel}
\end{equation} 
where $F_{||}$ is the force on the motor, projected along the tangent vector of the
actin filaments.
%\subsection{Dynamics and Environment}
\par
We solve for the motion of actin filaments using Brownian dynamics so that at
each time, the position of each filament bead and motor (crosslinker) head is 
updated via the equation
\begin{equation}  
  r(t+\Delta t) = r(t) + F(t)\mu \Delta t + B(t) \mu \Delta t
\label{eqn:overdamped}
\end{equation}
where $F(t)$ is the sum of internal and external forces on the bead (head), 
and $\mu = (4\pi R\nu)^{-1}$ where $\nu$ is the environment's dynamics viscosity. 
For the Brownian term, we use the form of
Leimkuhler and Matthews \cite{leimkuhler2012,leimkuhler2013} that has
been shown to minimize deviations from canonical averages in harmonic systems.
\par
We use periodic boundary conditions so as to limit effects of a
boundary and to mimic a system larger than the one we simulate. The value for 
$\Delta t$ in\Cref{eqn:overdamped} generally depends on both the unloaded myosin 
speed
$v_0$ and the largest stiffness in the simulation $k_f$. For $k_f = 1pN/\mu m$
and $v_0=1\mu m/s$ a value of $\Delta t = 0.0001 s$ was sufficiently low to
solve \Cref{eqn:overdamped} for hundreds of seconds without spuriously
generating configurations of very large energy. The length and width of the
simulations were chosen so as to be high enough to avoid boundary artifacts. 
Further detail regarding methods including a justification for parameter
value choices and pseudocode is available in \cite{freedman2016}.
A complete list of simulation parameters used throughout this
article is provided in \Cref{tab:params}. 
\begin{table}
  \caption{Parameter Values}
  \centering
  \begin{tabular}{|C{1cm}|L{7cm}|C{2.3cm}|C{2.3cm}|C{2.3cm}|}
    \hline\hline
    Symbol & Description (units) [ref] & Bundling & Polarity Sorting & Contractile\\
    \hline
    &\bf{Actin Filaments}& & & \\
    \hline
    $N_B$ & Number of beads & $16$ & $16$ &$16$\\
    $l_a$ & Link Rest Length ($\mu m$)\cite{odijk1983}& $1$ &$1$& $1$\\
    $k_a$ & Stretching Force Constant ($pN/\mu m$) & $1$ & $1$ & $1$\\
    $\kappa_B$ & Bending Modulus ($pN\mu m^2$)\cite{ott1993} & $0.08$ & $0.08$ & $0.08$\\
    \hline
    &\bf{Myosin Minifilaments}& & & \\
    \hline
    $\rho_m$ & Density($\mu m^{-2}$)& n/a & $[0.1,10]$,$1$&$[0.05,5]$,$0.5$\\
    $l_m$ & Rest Length ($\mu m$)\cite{niederman1975} & n/a & 0.5 & 0.5\\
    $k_m$ & Stiffness ($pN/\mu m$)& n/a & $1$ & $1$\\
    $k^{on}_m\Delta t$ & Attachment probability at distance $r=0$ & n/a & $0.9$ &$0.9$\\
    $k^{off}_m\Delta t$ & Unloaded head detachment probability  & n/a & $0.05$, $[10^{-7},1]$ & $0.05$, $[10^{-7},1]$\\
    $k^{end}_m\Delta t$ & Unloaded head detachment probability at the barbed end of the filament 
    & n/a & $0.5,[10^{-7},1]$ &$0.5,[10^{-7},1]$\\
    $x_m$ & characteristic bond length ($\mu m$) \cite{stam2015}& n/a& $0.001$ & $0.001$\\
    $v_0$ & Unloaded speed ($\mu m/s$) \cite{kron1986}&  n/a & $1$ & $1$\\
    $F_s$ & Stall force of myosin ($pN$)\cite{veigel2003}& n/a & $3.85$ & $3.85$\\
    \hline
    &\bf{Crosslinkers} & & & \\
    \hline
    $\rho_{cl}$ & Density($\mu m^{-2}$) &$[0.1,10]$,$1$&n/a&$[0.05,5]$,$0.5$\\
    $l_{cl}$& Rest Length (Filamin) ($\mu m$)\cite{ferrer2008} &$0.150$ &n/a&$0.150$ \\
    $k_{cl}$ & Stiffness ($pN/\mu m$)& $1$ & n/a& $1$\\
    $k^{on}_{cl}\Delta t$ & Attachment probability at distance $r=0$ & $0.9$ & n/a &$0.9$\\
  $k^{off}_{cl} \Delta t$& Unloaded head detachment probability& $0.005$, $[10^{-7},1]$ & n/a & $0.005$, $[10^{-7},1]$\\
    $x_{cl}$& characteristic bond length ($\mu m$) & $0.001$ & n/a & $0.001$ \\
    \hline
    &\bf{Environment} & & & \\
    \hline
    $dt$ & Dynamics timestep (s) & $0.0005$ & $0.00025$ & $0.0001$\\
    $T_F$& maximum simulated time (s) & $200$ & $200$ & $200$ \\
    $X$, $Y$ & Length and width of assay ($\mu m$)& $75$ & $75$ & $75$\\
    $r_c$ & Mesh (actomyosin binding site) size ($\mu m$) & $0.2$ & $0.2$ & $0.2$ \\ 
    $T$ & $k_B$ * Temperature ($pN\mu m$)& $0.004$& $0.004$& $0.004$\\
    $\nu$ & Dynamic viscosity ($mg/(\mu m s)$) & $0.001$& $0.001$& $0.001$\\
    \hline
  \end{tabular}
  \label{tab:params}
\end{table}

\section{Acknowledgements}  
We thank M. Gardel, J. Weare, C. Matthews, F. Nedelec, F. Mackintosh, and M.
Murrell for helpful conversations. This research was supported in part by the
University of Chicago Materials Research Science and Engineering Center
(NSF Grant No. 1420709). S.L.F. was supported by the DoD
through the NDSEG Program. G.M.H. was supported by an NIH Ruth L. Kirschstein
NRSA award (1F32GM113415-01).
\bibliography{actosim}
\bibliographystyle{unsrt}
\beginsupplement
\section{Supplement}
\subsection{Results}
\subsubsection{Bundling dependence on crosslinker density}
\subsubsection{Polarity sorting dependence on motor detachment rate}
\subsubsection{Contractile dependence on motor detachment rate}
\end{document}
